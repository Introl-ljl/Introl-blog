---
export interface Props {
  title: string;
  description: string;
  status: string;
  progress: number;
  tags: string[];
  category: string;
  lastUpdate: string;
  url?: string;
  demoUrl?: string;
  slug: string;
}

const { title, description, status, progress, tags, category, lastUpdate, url, demoUrl, slug } = Astro.props;

function getStatusColor(status: string): string {
  switch (status.toLowerCase()) {
    case '已完成':
    case 'completed':
      return 'status-completed';
    case '进行中':
    case 'in_progress':
    case '开发中':
      return 'status-in-progress';
    case '暂停':
    case 'paused':
      return 'status-paused';
    case '即将完成':
    case 'nearly_done':
      return 'status-nearly-done';
    default:
      return 'status-planned';
  }
}
---

<div class="bg-[var(--card-bg)] rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300 p-6 border border-[var(--line-divider)]">
  <div class="flex justify-between items-start mb-3">
    <h3 class="text-xl font-semibold text-90 hover:text-[var(--primary)] transition-colors">
      <a href={`/projects/${slug}/`}>{title}</a>
    </h3>
    <span class={`px-2 py-1 rounded-full text-xs font-medium ${getStatusColor(status)}`}>
      {status}
    </span>
  </div>
  
  <p class="text-75 mb-4 line-clamp-2">{description}</p>
  
  <div class="mb-4">
    <div class="flex justify-between items-center mb-2">
      <span class="text-sm text-50">进度</span>
      <span class="text-sm font-medium text-75">{progress}%</span>
    </div>
    <div class="w-full bg-[var(--btn-regular-bg)] rounded-full h-2">
      <div 
        class="bg-[var(--primary)] h-2 rounded-full transition-all duration-300" 
        style={`width: ${progress}%`}
      ></div>
    </div>
  </div>
  
  <div class="flex flex-wrap gap-2 mb-4">
    {tags.map((tag) => (
      <span class="px-2 py-1 bg-[var(--btn-regular-bg)] text-[var(--btn-content)] rounded-md text-xs">
        {tag}
      </span>
    ))}
  </div>
  
  <div class="flex justify-between items-center text-sm text-50 mb-4">
    <span class="bg-[var(--btn-plain-bg-hover)] text-[var(--primary)] px-2 py-1 rounded">{category}</span>
    <span>更新于 {lastUpdate}</span>
  </div>
  
  <div class="flex gap-2">
    <a 
      href={`/projects/${slug}/`}
      class="flex-1 bg-[var(--primary)] text-white px-4 py-2 rounded-md text-center hover:bg-[var(--primary)]/90 transition-colors text-sm"
    >
      查看详情
    </a>
    {url && (
      <a 
        href={url} 
        target="_blank" 
        rel="noopener noreferrer"
        class="px-4 py-2 border border-[var(--line-divider)] text-75 rounded-md hover:bg-[var(--btn-card-bg-hover)] transition-colors text-sm"
      >
        源码
      </a>
    )}
    {demoUrl && (
      <a 
        href={demoUrl} 
        target="_blank" 
        rel="noopener noreferrer"
        class="px-4 py-2 border border-[var(--line-divider)] text-75 rounded-md hover:bg-[var(--btn-card-bg-hover)] transition-colors text-sm"
      >
        演示
      </a>
    )}
  </div>
</div>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>